language: python
python:
  - "3.6"
sudo: required
env:
  - ETCDCTL_API=3
install:
  - pip install pytest-travis-fold
  - pip install requests
  - wget https://github.com/containous/traefik/releases/download/v1.7.0/traefik_linux-amd64
  - sudo chmod +x traefik_linux-amd64
  - sudo ln -s -T `pwd`/traefik_linux-amd64 /usr/local/bin/traefik
  - ls -l /usr/local/bin
  - wget https://github.com/etcd-io/etcd/releases/download/v3.3.10/etcd-v3.3.10-linux-amd64.tar.gz
  - tar xzvf etcd-v3.3.10-linux-amd64.tar.gz
  - ./etcd-v3.3.10-linux-amd64/etcd &
  - traefik storeconfig -c ./traefik/traefik.toml --etcd --etcd.endpoint=127.0.0.1:2379 --etcd.useapiv3=true
script:
  - pytest ./traefik/test_traefikPrefixRouting.py -s
